\input{../common}

\begin{document}
  %<*content>
  \lesson{analysis}{228}{Continuité, dérivabilité des fonctions réelles d'une variable réelle. Exemples et applications.}

  Soient $I$ un intervalle de $\mathbb{R}$ non réduit à un point et $f : I \rightarrow \mathbb{R}$ une fonction.

  \subsection{Continuité et dérivabilité}

  \subsubsection{Continuité}

  \reference[ROM19-1]{163}

  \begin{definition}
    \begin{itemize}
      \item $f$ est \textbf{continue au point $a \in I$} si
      \[ \forall \epsilon > 0, \, \exists \eta > 0, \, \forall x \in I, \, \vert x - a \vert < \eta \implies \vert f(x) - f(a) \vert < \epsilon \]
      \item $f$ est \textbf{continue sur $I$} si $f$ est continue en tout point de $I$.
    \end{itemize}
  \end{definition}

  \begin{example}
    Pour tout entier $n$, $x \mapsto x^n$ est continue sur $\mathbb{R}$.
  \end{example}

  \begin{theorem}[Caractérisations séquentielle et topologique de la continuité]
    \begin{enumerate}[label=(\roman*)]
      \item $f$ est continue en $a \in I$ si et seulement si toute suite de points de $I$ qui converge vers $a$ est transformée par $f$ en une suite convergente vers $f(a)$.
      \item $f$ est continue en $a \in I$ si et seulement si l'image réciproque par $f$ de tout ouvert (resp. fermé) de $\mathbb{R}$ est un ouvert (resp. fermé) de $I$.
    \end{enumerate}
  \end{theorem}

  \begin{example}
    La fonction $x \mapsto \cos \left( \frac{1}{x} \right)$ définie sur $\mathbb{R}_*$ n'est pas continue en $0$.
  \end{example}

  \begin{proposition}
    Si $f$ et $g$ sont deux fonctions définies sur $I$ à valeurs réelles et continues en $a \in I$, alors $\vert f \vert$, $f + g$, $fg$, $\min(f,g)$ et $\max(f,g)$ sont continues en $a$.
  \end{proposition}

  \subsubsection{Uniforme continuité}

  \reference[GOU20]{12}

  \begin{definition}
    $f$ est \textbf{uniformément continue sur $I$} si
    \[ \forall \epsilon > 0, \, \exists \eta > 0, \, \forall x, y \in I, \, \vert x - y \vert < \eta \implies \vert f(x) - f(y) < \epsilon \]
  \end{definition}

  \begin{remark}
    En particulier, une fonction uniformément continue sur un intervalle est continue sur ce même intervalle.
  \end{remark}

  \begin{example}
    Une fonction lipschitzienne sur $I$ est uniformément continue sur $I$.
  \end{example}

  \begin{cexample}
    La fonction $x \mapsto \frac{1}{x}$ définie sur $]0,1]$ est continue mais n'est pas uniformément continue.
  \end{cexample}

  \reference{18}

  \begin{proposition}
    On se place dans le cas où $I = \mathbb{R}^+$ et on suppose $f$ uniformément continue sur $\mathbb{R}^+$. Alors,
    \[ \exists \alpha, \beta \in \mathbb{R}^+_* \text{ tels que } \forall x \in \mathbb{R}^+, \vert f(x) \vert \leq \alpha x + \beta \]
  \end{proposition}

  \reference{24}

  \begin{theorem}[Prolongement des applications uniformément continues]
    Soit $J \subseteq I$ dense dans $I$ et soit $g : J \rightarrow \mathbb{R}$ uniformément continue sur $J$. Alors,
    \[ \exists! h : I \rightarrow \mathbb{R} \text{ uniformément continue et telle que } h_{|J} = g \]
  \end{theorem}

  \subsubsection{Dérivabilité}

  \reference{71}

  \begin{definition}
    On dit que $f$ est \textbf{dérivable en $a \in I$} si
    \[ \lim_{\substack{t \rightarrow a \\ t \neq a}} \frac{f(t) - f(a)}{t-a} \]
    existe. Lorsque cette limite existe, elle est notée $f'(a)$.
  \end{definition}

  \begin{remark}
    \begin{itemize}
      \item De même, $f$ est \textbf{dérivable à gauche (resp. à droite) en $a \in I$} si $\lim_{\substack{t \rightarrow a \\ t < a \\ t \in I}} \frac{f(t) - f(a)}{t-a}$ existe (resp. $\lim_{\substack{t \rightarrow a \\ t > a \\ t \in I}} \frac{f(t) - f(a)}{t-a}$ existe). On la note alors $f'_g(a)$ (resp. $f'_d(a)$).
      \item $f$ est dérivable en $a \in I$ si et seulement si $f$ est dérivable à gauche, à droite et $f'_g(a) = f'_d(a)$.
      \item $f$ est dérivable en $a \in I$ si et seulement si, quand $x$ tend vers $a$,
      \[ \exists \ell \in \mathbb{R}, \, f(x) = f(a) + (x-a)\ell + o(x-a) \]
    \end{itemize}
  \end{remark}

  \begin{proposition}
    Si $f$ est dérivable en $a \in I$, alors $f$ est continue en $a$.
  \end{proposition}

  \reference{86}

  \begin{cexample}
    On note $\Delta$ la fonction définie sur $\mathbb{R}$ $1$-périodique et telle que la restriction à $\left[ -\frac{1}{2}, \frac{1}{2} \right]$ vérifie $\Delta(x) = \vert x \vert$. Alors,
    \[ f : x \mapsto \sum_{p=0}^{+\infty} \frac{1}{2^p} \Delta (2^p x) \]
    est bien définie, continue sur $\mathbb{R}$, mais dérivable en aucun point de $\mathbb{R}$.
  \end{cexample}

  \reference{72}

  \begin{remark}
    La fonction dérivée $f' : x \mapsto f'(x)$ n'est pas forcément continue là où elle est définie.
  \end{remark}

  \begin{example}
    La fonction $x \mapsto \begin{cases}
      x^2 \sin \left(\frac{1}{x}\right) \text{ si x } \neq 0 \\
      0 \text{ sinon}
    \end{cases}$ définie sur $\mathbb{R}$ est dérivable, de dérivée $x \mapsto \begin{cases}
    2x \sin \left(\frac{1}{x}\right) - \cos \left(\frac{1}{x}\right) \text{ si x } \neq 0 \\
    0 \text{ sinon}
    \end{cases}$ définie sur $\mathbb{R}$ mais non continue en $0$.
  \end{example}

  \begin{proposition}
    Si $f$ et $g$ sont deux fonctions définies sur $I$ à valeurs réelles et dérivables en $a \in I$. Alors :
    \begin{enumerate}[label=(\roman*)]
      \item $\forall \lambda, \mu \in \mathbb{R}, \, \lambda f + \mu g$ est dérivable en $a$ et $(\lambda f + \mu g)'(a) = \lambda f'(a) + \mu g'(a)$.
      \item $fg$ est dérivable en $a$ et $(fg)'(a) = f'(a) g(a) + f(a) g'(a)$.
      \item Si $g(a) \neq 0$, alors $\frac{f}{g}$ est dérivable en $a$ et $\left(\frac{f}{g}\right)'(a) = \frac{f'(a) g(a) - f(a) g'(a)}{g(a)^2}$.
     \end{enumerate}
  \end{proposition}

  \begin{definition}
    On dit que $f$ est \textbf{de classe $\mathcal{C}^n$ sur $I$} si $\forall k \in \llbracket 0, n \rrbracket$, $f^{(k)}$ (la dérivée $k$-ième de $f$) existe et continue.
  \end{definition}

  \begin{proposition}[Formule de Leibniz]
    Soit $a \in I$. Si $f$ et $g$ sont deux fonctions définies sur $I$ à valeurs réelles et qui admettent une dérivée $n$-ième en $a$,
    \[ (fg)^{(n)}(a) = \sum_{k=0}^n \binom{n}{k} f^{(k)}(a) g^{(n-k)}(a) \]
  \end{proposition}

  \begin{proposition}
    Soit $J$ un intervalle de $\mathbb{R}$. Si $f : I \rightarrow \mathbb{R}$ et $g : J \rightarrow I$ sont deux fonctions, alors, en supposant $f$ dérivable en $a$ et $g$ dérivable en $f(a)$, $(f \circ g)$ est dérivable en $a$ et,
    \[ (f \circ g)'(a) = g'(a) (f' \circ g)(a) \]
  \end{proposition}

  \begin{corollary}
    Soient $J$ un intervalle de $\mathbb{R}$ et $h : I \rightarrow J$ une bijection dérivable en $a \in I$. Alors, $h^{-1}$ est dérivable en $b = h(a)$ si et seulement si $h'(a) \neq 0$, et on a,
    \[ (h^{-1})'(b) = \frac{1}{h'(a)} = \frac{1}{h'(h^{-1}(b))} \]
  \end{corollary}

  \begin{corollary}
    La composée de deux applications de classe $\mathcal{C}^n$ est de classe $\mathcal{C}^n$.
  \end{corollary}

  \subsection{Fonctions particulières qui sont dérivables ou continues}

  \subsubsection{Fonctions convexes}

  \reference[ROM19-1]{225}

  \begin{definition}
    $f$ est \textbf{convexe} si
    \[ \forall x, y \in I, \, \forall t \in [0,1], \, f((1-t)x + ty) \leq (1-t)f(x) + tf(y) \]
  \end{definition}

  \begin{example}
    \begin{itemize}
      \item $x \mapsto \vert x \vert$ est convexe sur $\mathbb{R}$.
      \item $\exp$ est convexe sur $\mathbb{R}$.
    \end{itemize}
  \end{example}

  \reference[GOU20]{96}

  \begin{proposition}
    Si $f$ est convexe, elle possède en tout point de $\mathring{I}$ une dérivée à droite et une dérivée à gauche. Elle est donc continue sur $\mathring{I}$. De plus les applications dérivées à gauche $f'_g$ et à droite $f'_d$ sont croissantes avec $f'_g(x) \leq f'_d(x)$ pour tout $x \in \mathring{I}$.
  \end{proposition}

  \begin{proposition}
    On suppose $f$ deux fois dérivable. Alors, $f$ est convexe si et seulement si $f''(x) \geq 0$ pour tout $x \in I$.
  \end{proposition}

  \reference[ROU]{152}
  \dev{methode-de-newton}

  \begin{application}[Méthode de Newton]
    Soit $g : [c, d] \rightarrow \mathbb{R}$ une fonction de classe $\mathcal{C}^2$ strictement croissante sur $[c, d]$. On considère la fonction
    \[ \varphi :
    \begin{array}{ccc}
      [c, d] &\rightarrow& \mathbb{R} \\
      x &\mapsto& x - \frac{g(x)}{g'(x)}
    \end{array}
    \]
    (qui est bien définie car $g' > 0$). Alors :
    \begin{enumerate}[label=(\roman*)]
      \item $\exists! a \in [c, d]$ tel que $g(a) = 0$.
      \item $\exists \alpha > 0$ tel que $I = [a - \alpha, a + \alpha]$ est stable par $\varphi$.
      \item La suite $(x_n)$ des itérés (définie par récurrence par $x_{n+1} = \varphi(x_n)$ pour tout $n \geq 0$) converge quadratiquement vers $a$ pour tout $x_0 \in I$.
    \end{enumerate}
  \end{application}

  \begin{corollary}
    En reprenant les hypothèses et notations du théorème précédent, et en supposant de plus $g$ strictement convexe sur $[c, d]$, le résultat du théorème est vrai sur $I = [a, d]$. De plus :
    \begin{enumerate}[label=(\roman*)]
      \item $(x_n)$ est strictement décroissante (ou constante).
      \item $x_{n+1} - a \sim \frac{f''(a)}{2f'(a)} (x_n - a)^2$ pour $x_0 > a$.
    \end{enumerate}
  \end{corollary}

  \begin{example}
    \begin{itemize}
      \item On fixe $y > 0$. En itérant la fonction $F : x \mapsto \frac{1}{2} \left( x + \frac{y}{x} \right)$ pour un nombre de départ compris entre $c$ et $d$ où $0 < c < d$ et $c^2 < 0 < d^2$, on peut obtenir une approximation du nombre $\sqrt{y}$.
      \item En itérant la fonction $F : x \mapsto \frac{x^2+1}{2x-1}$ pour un nombre de départ supérieur à $2$, on peut obtenir une approximation du nombre d'or $\varphi = \frac{1+\sqrt{5}}{2}$.
    \end{itemize}
  \end{example}

  \subsubsection{Fonction monotones}

  \reference[R-R]{31}

  \begin{definition}
    \begin{itemize}
      \item On dit que $f$ est \textbf{croissante} si $\forall x, y \in I, \, x \leq y \implies f(x) \leq f(y)$.
      \item On dit que $f$ est \textbf{décroissante} si $\forall x, y \in I, \, x \leq y \implies f(x) \geq f(y)$.
      \item On dit que $f$ est \textbf{monotone} si $f$ est croissante ou décroissante.
    \end{itemize}
  \end{definition}

  \reference[ROM19-1]{163}

  \begin{definition}
    Si $a \in \mathring{I}$, et si $f$ est discontinue en $a$ avec des limites à gauche et à droite en ce point, on dit que $f$ a une \textbf{discontinuité de première espèce} en $a$.
  \end{definition}

  \begin{proposition}
    Une fonction monotone de $I$ dans $\mathbb{R}$ ne peut avoir que des discontinuités de première espèce.
  \end{proposition}

  \begin{theorem}
    On suppose que $I$ est un intervalle ouvert. Si $f$ est une fonction monotone, alors l'ensemble des points de discontinuités de $f$ est dénombrable.
  \end{theorem}

  \begin{example}
    La fonction $f$ définie sur $[0,1]$ par $f(0) = 0$ et $f(x) = \frac{1}{\lfloor \frac{1}{x} \rfloor}$ est croissante avec une infinité de points de discontinuité.
  \end{example}

  \reference{175}

  \begin{proposition}
    Si $f$ est une fonction monotone telle que $f(I)$ est un intervalle, elle est alors continue sur $I$.
  \end{proposition}

  \begin{theorem}[Bijection]
    Si $f$ est une application continue et strictement monotone sur $I$, alors :
    \begin{enumerate}[label=(\roman*)]
      \item $f(I)$ est un intervalle.
      \item $f^{-1}$ est continue.
      \item $f^{-1}$ est strictement monotone de même sens de variation que $f$.
    \end{enumerate}
  \end{theorem}

  \begin{example}
    La fonction $\exp : x \mapsto e^x$ est une bijection de $\mathbb{R}$ dans $\mathbb{R}^{+}_{*}$ qui admet donc une bijection réciproque $\ln$ qui est strictement croissante.
  \end{example}

  \reference[D-L]{405}

  \begin{theorem}[Lebesgue]
    Une application monotone est dérivable presque partout.
  \end{theorem}

  \subsection{Propriétés importantes}

  \subsubsection{Théorème des valeurs intermédiaires}

  \reference[GOU20]{41}

  \begin{theorem}[Des valeurs intermédiaires]
    On suppose $f$ continue sur $I$. Alors $f(I)$ est un intervalle.
  \end{theorem}

  \begin{remark}
    Une autre manière d'écrire ce résultat est la suivante. Si $f(a) \leq f(b)$ (resp. $f(a) \geq f(b)$) avec $a < b$, alors pour tout $f(a) \leq \gamma \leq f(b)$ (resp. $f(b) \leq \gamma \leq f(a)$), il existe $c \in [a,b]$ tel que $f(c) = \gamma$.
  \end{remark}

  \begin{corollary}
    L'image d'un segment de $\mathbb{R}$ par $f$ est un segment de $\mathbb{R}$.
  \end{corollary}

  \subsubsection{Théorème de Rolle}

  Dans cette partie, $I$ désigne un segment $[a,b]$ de $\mathbb{R}$ non réduit à un point.

  \begin{theorem}[Rolle]
    On suppose $f$ continue sur $[a,b]$, dérivable sur $]a,b[$ et telle que $f(a) = f(b)$. Alors,
    \[ \exists c \in ]a,b[ \text{ tel que } f'(c) = 0 \]
  \end{theorem}

  \begin{theorem}[Des accroissements finis]
    On suppose $f$ continue sur $[a,b]$ et dérivable sur $]a,b[$. Alors,
    \[ \exists c \in ]a,b[ \text{ tel que } f'(c) = \frac{f(b) - f(a)}{b-a} \]
  \end{theorem}

  \begin{corollary}
    On suppose $f$ continue sur $[a,b]$ et dérivable sur $]a,b[$. Alors, $f$ est croissante si et seulement si $f'(x) \geq 0$ pour tout $x \in ]a,b[$, avec égalité si et seulement si $f$ est constante.
  \end{corollary}

  \begin{corollary}
    On suppose $f$ continue sur $[a,b[$ et dérivable sur $]a,b[$ et telle que $\ell = \lim_{\substack{t \rightarrow a \\ t > a}} f'(t)$ existe. Alors, $f$ est dérivable en $a$ et $f'(a) = \ell$.
  \end{corollary}

  \reference{80}

  \begin{theorem}[Darboux]
    On suppose $f$ dérivable sur $I$. Alors $f'(I)$ est un intervalle.
  \end{theorem}

  \subsubsection{Formules de Taylor}

  \reference{75}

  Dans cette partie, $I$ désigne encore un segment $[a,b]$ de $\mathbb{R}$ non réduit à un point.

  \begin{theorem}[Formule de Taylor-Lagrange]
    On suppose $f$ de classe $\mathcal{C}^n$ sur $[a,b]$ telle que $f^{(n+1)}$ existe sur $]a,b[$. Alors,
    \[ \exists c \in ]a,b[ \text{ tel que } f(b) = \sum_{k=0}^{n} \frac{f^{(k)} (a)}{k!} (b-a)^k + \frac{f^{(n+1)}(c)}{(n+1)!} (b-a)^{n+1} \]
  \end{theorem}

  \begin{application}
    \begin{itemize}
      \item $\forall x \in \mathbb{R}^+, \, x - \frac{x^2}{2} \leq \ln(1+x) \leq x - \frac{x^2}{2} + \frac{x^3}{3}$.
      \item $\forall x \in \mathbb{R}^+, \, x - \frac{x^3}{6} \leq \sin(x) \leq x - \frac{x^3}{6} + \frac{x^5}{120}$.
      \item $\forall x \in \mathbb{R}, \, 1 - \frac{x^2}{2} \leq \cos(x) \leq 1 - \frac{x^2}{2} + \frac{x^4}{24}$.
    \end{itemize}
  \end{application}

  \subsubsection{Continuité sur un compact}

  \reference{31}

  \begin{theorem}[des bornes]
    Une fonction continue sur un compact est bornée et atteint ses bornes.
  \end{theorem}

  \begin{theorem}[Heine]
    Une fonction continue sur un compact y est uniformément continue.
  \end{theorem}

  \reference{242}

  \begin{theorem}[Bernstein]
    On suppose $I = [0,1]$ et $f$ continue sur $[0,1]$. On note
    \[ B_n(f) : x \mapsto \sum_{k=0}^{n} f\left(\frac{k}{n}\right) \binom{n}{k} x^k (1-x)^{n-k} \]
    Alors,
    \[ \Vert B_n(f) - f \Vert_\infty \longrightarrow_{n \rightarrow +\infty} 0 \]
  \end{theorem}

  \reference{304}
  \dev{theoreme-de-weierstrass-par-la-convolution}

  \begin{theorem}[Weierstrass]
    Toute fonction continue sur un compact est limite uniforme de fonctions polynômiales.
  \end{theorem}

  \subsection{Régularité des fonctions limites}

  \subsubsection{Suites et séries de fonctions}

  \reference{233}

  \begin{proposition}
    Si une suite de fonctions est continue en un point $a$ et converge uniformément vers une fonction limite, alors celle-ci est continue en $a$.
  \end{proposition}

  \begin{cexample}
    La suite de fonctions $(g_n)$ définie pour tout $n \in \mathbb{N}$ et pour tout $x \in [0,1]$ par $g_n(x) = x^n$ converge vers une fonction non continue.
  \end{cexample}

  \begin{proposition}
    On suppose que $I$ est un segment $[a,b]$ de $\mathbb{R}$ non réduit à un point. Soit $(f_n)$ une suite de fonctions de $I$ dans $\mathbb{R}$. On suppose que :
    \begin{enumerate}[label=(\roman*)]
      \item Il existe $x_0 \in [a,b]$ tel que $(f_n(x_0))$ converge.
      \item La suite $(f'_n)$ converge uniformément sur $[a,b]$ vers une fonction $g$.
    \end{enumerate}
    Alors $(f_n)$ converge uniformément vers une fonction $f$ de classe $\mathcal{C}^1$ sur $[a,b]$ et telle que $f'=g$.
  \end{proposition}

  \reference{302}

  \begin{example}
    La fonction $\zeta : s \mapsto \sum_{n=1}^{+\infty} \frac{1}{n^s}$ est $\mathcal{C}^\infty$ sur $]1,+\infty[$.
  \end{example}

  \subsubsection{Fonctions définies par une intégrale}

  \reference[Z-Q]{312}

  Soient $(X, \mathcal{A}, \mu)$ un espace mesuré et $g : E \times X \rightarrow \mathbb{C}$ où $(E, d)$ est un espace métrique. On pose $G : t \mapsto \int_X g(t, x) \, \mathrm{d}\mu(x)$.

  \begin{theorem}[Continuité sous le signe intégral]
    On suppose :
    \begin{enumerate}[label=(\roman*)]
      \item $\forall t \in E$, $x \mapsto g(t,x)$ est mesurable.
      \item pp. en $x \in X$, $t \mapsto g(t,x)$ est continue en $t_0 \in E$.
      \item $\exists h \in L_1(X)$ positive telle que
      \[ |g(t,x)| \leq h(x) \quad \forall t \in E, \text{pp. en } x \in X \]
    \end{enumerate}
    Alors $G$ est continue en $t_0$.
  \end{theorem}

  \begin{theorem}[Dérivation sous le signe intégral]
    On suppose :
    \begin{enumerate}[label=(\roman*)]
      \item $\forall t \in I$, $x \mapsto g(t,x) \in L_1(X)$.
      \item pp. en $x \in X$, $t \mapsto g(t,x)$ est dérivable sur $I$. On notera $\frac{\partial g}{\partial t}$ cette dérivée définie presque partout.
      \item $\forall K \subseteq I$ compact, $\exists h_K \in L_1(X)$ positive telle que
      \[ \left| \frac{\partial g}{\partial t}(x,t) \right| \leq h_K(x) \quad \forall t \in I, \text{pp. en } x \]
    \end{enumerate}
    Alors $\forall t \in I$, $x \mapsto \frac{\partial g}{\partial t}(x, t) \in L_1(X)$ et $G$ est dérivable sur $I$ avec
    \[ \forall t \in I, \, G'(t) = \int_X \frac{\partial g}{\partial t}(x, t) \, \mathrm{d}\mu(x) \]
  \end{theorem}

  \reference[G-K]{107}

  \begin{application}[Intégrale de Dirichlet]
    On pose $\forall x \geq 0$,
    \[ F(x) = \int_0^{+\infty} \frac{\sin(t)}{t} e^{-xt} \, \mathrm{d}t \]
    alors :
    \begin{enumerate}[label=(\roman*)]
      \item $F$ est bien définie et est continue sur $\mathbb{R}^+$.
      \item $F$ est dérivable sur $\mathbb{R}^+_*$ et $\forall x \in \mathbb{R}^+_*$, $F'(x) = -\frac{1}{1+x^2}$.
      \item $F(0) = \int_0^{+\infty} \frac{\sin(t)}{t} \, \mathrm{d}t = \frac{\pi}{2}$.
    \end{enumerate}
  \end{application}

  \annexessection

  \reference[GOU20]{73}

  \begin{figure}[H]
    \begin{center}
      \begin{whitetabularx}{|X|X|}
        \hline
        \textbf{Valeur de $f(x)$} & \textbf{Valeur de $f'(x)$} \\
        \hline
        $x^r$ ($r \in \mathbb{R}$) & $rx^{r-1}$ \\
        \hline
        $\ln(x)$ & $\frac{1}{x}$ \\
        \hline
        $\sin(x)$ & $\cos(x)$ \\
        \hline
        $\cos(x)$ & $-\sin(x)$ \\
        \hline
        $\tan(x)$ & $\frac{1}{\cos(x)^2}$ \\
        \hline
        $e^x$ & $e^x$ \\
        \hline
        $\arctan(x)$ & $\frac{1}{1+x^2}$ \\
        \hline
        $\arcsin(x)$ & $\frac{1}{\sqrt{1-x^2}}$ \\
        \hline
        $\arccos(x)$ & $-\frac{1}{\sqrt{1-x^2}}$ \\
        \hline
      \end{whitetabularx}
    \end{center}
    \caption{Dérivées de fonctions usuelles.}
  \end{figure}
  %</content>
\end{document}
