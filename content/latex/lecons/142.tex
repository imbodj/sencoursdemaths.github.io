\input{../common}

\begin{document}
  %<*content>
  \lesson{algebra}{142}{PGCD et PPCM, algorithmes de calcul. Applications.}

  \subsection{Notion de PGCM/PPCM dans un anneau}

  Soit $A$ un anneau commutatif unitaire.

  \reference[ULM18]{39}

  \begin{definition}
    Soient $a, b \in A$.
    \begin{itemize}
      \item On dit que $a$ \textbf{divise} $b$ (ou que $b$ est un multiple de $a$), noté $a \mid b$ s'il existe $c \in A$ tel que $b = ac$.
      \item On dit que $a$ et $b$ sont \textbf{associés}, noté $a \sim b$ si $a \mid b$ et si $b \mid a$.
    \end{itemize}
  \end{definition}

  \begin{remark}
    Soient $a, b \in A$.
    \begin{itemize}
      \item $a \mid b \iff (b) \subseteq (a)$.
      \item $a \sim b \iff (b) = (a)$. Ainsi, $\sim$ est une relation d'équivalence sur $A$.
    \end{itemize}
  \end{remark}

  \begin{proposition}
    Soient $a, b \in A$. Alors,
    \[ a \sim b \iff \exists u \in A^\times \text{ tel que } b = ua \]
  \end{proposition}

  \begin{definition}
    Soient $a_1, \dots, a_n \in A^*$.
    \begin{itemize}
      \item $d \in A$ est un \textbf{plus grand commun diviseur} ``PGCD'' de $a_1, \dots, a_m$ si $d$ satisfait les deux propriétés suivantes :
      \begin{enumerate}[label=(\roman*)]
        \item $d \mid a_i, \forall i \in \llbracket 1, n \rrbracket$.
        \item Si $\exists d' \in A$ tel que $d' \mid a_i, \forall i \in \llbracket 1, n \rrbracket$, alors $d' \mid d$.
      \end{enumerate}
      \item $m \in A$ est un \textbf{plus petit commun multiple} ``PPCM'' de $a_1, \dots, a_n$ si $m$ satisfait les deux propriétés suivantes :
      \begin{enumerate}[label=(\roman*)]
        \item $a_i \mid m, \forall i \in \llbracket 1, n \rrbracket$.
        \item Si $\exists m' \in A$ tel que $a_i \mid m', \forall i \in \llbracket 1, n \rrbracket$, alors $m \mid m'$.
      \end{enumerate}
    \end{itemize}
  \end{definition}

  \begin{remark}
    Un PGCD (resp. un PPCM), lorsqu'il existe, n'est pas toujours unique. Dans un anneau intègre, deux PGCD (resp. PPCM) sont toujours associés puisqu'ils se divisent l'un l'autre. Dans un anneau intègre, on peut donc noter $d \sim \operatorname{pgcd}(a, b)$ (resp. $m \sim \operatorname{pgcd}(a, b)$) lorsque $d$ est un pgcd (resp. $m$ est un ppcm) de $a$ et de $b$.
  \end{remark}

  \reference[GOU21]{60}

  \begin{example}
    Soient $\mathbb{K}$ un corps commutatif. On pose $P_n = X^n - 1 \in \mathbb{K}[X]$ pour $n \in \mathbb{N}^*$. Alors, pour $a, b \in \mathbb{N}^*$, le PGCD unitaire de $P_a$ et $P_b$ est égal à $P_{\operatorname{pgcd}(a,b)}$.
  \end{example}

  \reference[ULM18]{40}

  \begin{proposition}
    Soient $a, b \in A^*$. Un élément $c \in A$ est un PPCM de $a$ et $b$ si et seulement si $(a) \, \cap \, (b) = (c)$. En particulier, $a$ et $b$ admettent un PPCM si et seulement si $(a) \, \cap \, (b)$ est un idéal principal.
  \end{proposition}

  \begin{proposition}
    Soient $a, b \in A^*$. Soit $d \in A$. Les assertions suivantes sont équivalentes.
    \begin{enumerate}[label=(\roman*)]
      \item $d \mid a$, $d \mid b$ et il existe $u, v \in A$ tels que $d = au + bv$.
      \item $d \sim \operatorname{pgcd}(a, b)$ et il existe $u, v \in A$ tels que $d = au + bv$.
      \item $(d) = (a,b)$.
    \end{enumerate}
  \end{proposition}

  \begin{definition}
    Deux éléments $a$ et $b$ de $A$ sont dits \textbf{premiers entre eux} s'ils admettent un PGCD et $\operatorname{pgcd}(a,b) \sim 1$.
  \end{definition}

  \begin{example}
    $2$ et $X$ sont premiers entre eux dans $\mathbb{Z}[X]$.
  \end{example}

  \subsection{Dans un anneau principal}

  Dans cette section, $A$ désigne toujours un anneau commutatif unitaire. On le suppose de plus principal.

  \subsubsection{Existence}

  \begin{theorem}[Décomposition de Bézout]
    Soient $a_1, \dots, a_n \in A^*$. Alors :
    \begin{enumerate}[label=(\roman*)]
      \item Il existe $d$ un $\operatorname{pgcd}$ de $a_1, \dots, a_n$. $d$ est tel que $(d) = (a_1, \dots, a_n)$. En particulier, $d$ est de la forme $d = b_1 a_1 + \dots + b_n a_n$ avec $\forall i \in \llbracket 1, n \rrbracket, \, b_i \in A$.
      \item Il existe $m$ un $\operatorname{ppcm}$ de $a_1, \dots, a_n$. $m$ est tel que $(m) = (a_1) \cap \dots \cap (a_n)$.
    \end{enumerate}
  \end{theorem}

  \reference{52}

  \begin{example}
    Dans $\mathbb{F}_2[X]$ :
    \[ -X(X^3+X^2+1) + (1+X^2)(X^2+X+1) = 1 \]
  \end{example}

  \begin{application}
    $\overline{X}^2+1$ est inversible dans $\mathbb{F}_2[X]/(X^3 + X^2 + 1)$ d'inverse $\overline{X}^2+X+1$.
  \end{application}

  \reference{42}

  \begin{lemma}[Gauss]
    Soient $a, b, c \in A$ avec $a$ et $b$ premiers entre eux. Alors,
    \[ a \mid bc \implies a \mid c \]
    et
    \[ a \mid c \text{ et } b \mid c \implies ab \mid c \]
  \end{lemma}

  \subsubsection{Dans les anneaux euclidiens}

  \paragraph{Principalité des anneaux euclidiens}

  \begin{proposition}
    Un anneau euclidien est principal.
  \end{proposition}

  On a donc existence de PGCD et de PPCM dans un tel anneau, mais la structure euclidienne permet de plus de fournir des algorithmes de calculs.

  \reference{47}

  \begin{theorem}
    Si $\mathbb{K}$ est un corps commutatif, alors $\mathbb{K}[X]$ est un anneau euclidien de stathme le degré. De plus, le quotient et le reste sont uniques.
  \end{theorem}

  \begin{corollary}
    Les assertions suivantes sont équivalentes :
    \begin{enumerate}[label=(\roman*)]
      \item $A$ est un corps commutatif.
      \item $A[X]$ est un anneau euclidien.
      \item $A[X]$ est un anneau principal.
    \end{enumerate}
  \end{corollary}

  \paragraph{Algorithmes de calcul}

  %\begin{proposition}
  %  On suppose $A$ euclidien. Le PGCD $d$ et le PPCM de $a_1, \dots, a_n \in A$ existent et $d$ est une combinaison linéaire de $a_1, \dots, a_n$.
  %\end{proposition}

  \reference[ROM21]{264}

  \begin{lemma}
    On suppose $A$ euclidien de stathme $\nu$. Soient $a, b \in A^*$ et $r$ un reste dans la division euclidienne de $a$ par $b$. À inversible près, on a alors :
    \begin{itemize}
      \item \uline{Si $r = 0$ :} $\operatorname{pgcd}(a,b) = b$.
      \item \uline{Sinon :} $\operatorname{pgcd}(a,b) = \operatorname{pgcd}(b,r)$.
    \end{itemize}
  \end{lemma}

  \begin{theorem}[Algorithme d'Euclide]
    \label{142-1}
    On suppose $A$ euclidien de stathme $\nu$. Soient $a, b \in A^*$ tels que $\nu(a) \geq \nu(b)$. On définit une suite $(r_k)$ décroissante (au sens du stathme) par :
    \begin{itemize}
      \item $r_k = b$ ;
      \item $r_1$ est un reste dans la division euclidienne de $a$ par $b$, on a donc $r_1 = 0$ ou $0 \leq \nu(r_1) < \nu(r_0)$ ;
      \item pour $k \geq 2$, si $r_{k-1} = 0$, alors $r_k = 0$, sinon $r_k$ est un reste dans la division euclidienne de $r_{k-2}$ par $r_{k-1}$ et on a $r_k = 0$ ou $0 \leq \nu(r_k) < \nu(r_{k-1})$.
    \end{itemize}
    $\operatorname{pgcd}(a,b)$ est alors le dernier reste non nul dans cette suite de divisions euclidiennes, que l'on note $r_{n-1}$.
  \end{theorem}

  \begin{remark}
    On peut ``remonter'' l'algorithme d'Euclide pour obtenir les coefficients de Bézout. On parle alors d'algorithme d'Euclide ``étendu''.
  \end{remark}

  \reference[ULM18]{44}

  Au lieu de faire les calculs en deux temps (descente, puis remontée), on peut tout faire en même temps via l'algorithme suivant.

  \begin{proposition}[Algorithme d'Euclide généralisé]
    En reprenant les notations du \cref{142-1} :
    \begin{itemize}
      \item \uline{Étape 0 :} On écrit $r_0 = a = u_0 \times a + v_0 \times b$ avec $(u_0, v_0) = (1, 0)$.
      \item \uline{Étape 1 :} On écrit $r_1 = b = u_1 \times a + v_1 \times b$ avec $(u_1, v_1) = (0, 1)$.
      \item \uline{Étape 2 :} On écrit $r_0 - q_1r_1 = r_2 = u_2 \times a + v_2 \times b$ avec $(u_2, v_2) = (1, -q_1)$.
      \item \dots
      \item \uline{Étape $k$ :} On écrit $r_{k-1} - q_k r_k = r_{k+1} = u_{k+1} \times a + v_{k+1} \times b$.
      \item \dots
      \item \uline{Étape $n-1$ :} On écrit $r_{n-2} - q_{n-1} r_{n-1} = r_n = u_n \times a + v_n \times b$.
      \item \uline{Étape $n$ :} On écrit $r_{n-1} - q_n r_n = 0 = u_{n+1} \times a + v_{n+1} \times b$.
    \end{itemize}
    À la fin, on obtient $\operatorname{pgcd}(a,b) = r_n = u_n a + v_n b$.
  \end{proposition}

  \begin{example}
    Calculons le PGCD et les coefficients de Bézout de $1763$ et $731$ dans $\mathbb{Z}$.
    \begin{center}
      \begin{whitetabularx}{lcr|llllllllll}
        & & & & $1763$ & = & $1$ & \times & $1763$ & + & $0$ & \times & $731$ \\
        & & & & $731$ & = & $0$ & \times & $1763$ & + & $1$ & \times & $731$ \\
        \hline
        Il y va & $2$ & fois & reste & $301$ & = & $1$ & \times & $1763$ & + & $(-2)$ & \times & $731$ \\
        & $2$ & fois & reste & $129$ & = & $(-2)$ & \times & $1763$ & + & $5$ & \times & $731$ \\
        & $2$ & fois & reste & $43$ & = & $5$ & \times & $1763$ & + & $(-12)$ & \times & $731$ \\
        & $3$ & fois & reste & $0$ & = & $(-17)$ & \times & $1763$ & + & $41$ & \times & $731$ \\
      \end{whitetabularx}
    \end{center}
    On a $\operatorname{pgcd}(1763,731) = 43 = 5 \times 1763 - 12 \times 731$.
  \end{example}

  \reference[FFN]{23}

  \begin{proposition}
    En reprenant les notations précédentes, on a
    \[ \forall k \in \llbracket 0,n-1 \rrbracket, \, r_k \geq \left( \frac{1+\sqrt{5}}{2} \right)^{n-k} \]
  \end{proposition}

  \begin{corollary}
    En reprenant les notations précédentes, cet algorithme a une complexité en $O(\ln(a) \times \ln(b))$.
  \end{corollary}

  \subsubsection{Dans un anneau factoriel}

  \reference[PER]{48}

  \begin{proposition}
    Si $A$ vérifie la relation $(*)$ de la \cref{142-2}, alors les assertions suivantes sont équivalentes :
    \begin{enumerate}[label=(\roman*)]
      \item $A$ vérifie le lemme d'Euclide : si $p \in A$ est irréductible, alors $p \mid ab \implies p \mid a \text { ou } p \mid b$.
      \item Pour tout $p \in A$, $p$ est irréductible si et seulement si $(p)$ premier.
      \item $A$ vérifie le lemme de Gauss : si $p \in A$ est irréductible, alors $a \mid bc \implies a \mid c$ pour tout $a, b, c \in A$ avec $a$ et $b$ premiers entre eux.
    \end{enumerate}
  \end{proposition}

  \reference[ULM18]{65}

  \begin{proposition}
    \label{142-2}
    On suppose $A$ factoriel. Tout élément $a \neq 0$ peut s'écrire de manière unique
    \[ a = u_a \prod_{p \in \mathcal{S}} p^{v_p(a)} \tag{$*$} \]
    où $\mathcal{S}$ est un \textbf{système de représentants d'éléments premiers} de $A$ (pour le relation $\sim$), $u_a$ est inversible et $v_p(a) \in \mathbb{N}$ tous nuls sauf un nombre fini.
  \end{proposition}

  \begin{example}
    Dans l'anneau principal (donc factoriel, voir \cref{142-3}) $\mathbb{Z}$, un choix standard pour $\mathcal{S}$ est l'ensemble des nombres premiers positifs.
  \end{example}

  \begin{proposition}
    On suppose $A$ factoriel. Soient $a, b \in A^*$. Alors, en reprenant les notations précédentes :
    \begin{enumerate}[label=(\roman*)]
      \item $a \mid b \iff v_p(a) \leq v_p(b)$ pour tout $p \in \mathcal{S}$.
      \item $\prod_{p \in \mathcal{S}} p^{\min(v_p(a), v_p(b))}$ est un PGCD de $a$ et de $b$.
      \item $\prod_{p \in \mathcal{S}} p^{\max(v_p(a), v_p(b))}$ est un PPCM de $a$ et de $b$.
    \end{enumerate}
  \end{proposition}

  \begin{theorem}
    \label{142-3}
    Tout anneau principal est factoriel.
  \end{theorem}

  \begin{cexample}
    $\mathbb{Z}[i\sqrt{5}]$ est principal mais n'est pas factoriel.
  \end{cexample}

  \reference[GOZ]{10}

  \begin{lemma}[Gauss]
    On suppose $A$ factoriel. Alors :
    \begin{enumerate}[label=(\roman*)]
      \item Le produit de deux polynômes primitifs est primitif (ie. dont le PGCD des coefficients est associé à $1$).
      \item $\forall P, Q \in A[X] \setminus \{ 0 \}$, $\gamma(PQ) = \gamma(P) \gamma(Q)$ (où $\gamma(P)$ est le contenu du polynôme $P$).
    \end{enumerate}
  \end{lemma}

  \dev{critere-d-eisenstein}

  \begin{theorem}[Critère d'Eisenstein]
    Soient $\mathbb{K}$ le corps des fractions de $A$ et $P = \sum_{i=0}^n a_i X^i \in A[X]$ de degré $n \geq 1$. On suppose que $A$ est factoriel et qu'il existe $p \in A$ irréductible tel que :
    \begin{enumerate}[label=(\roman*)]
      \item $p \mid a_i$, $\forall i \in \llbracket 0, n-1 \rrbracket$.
      \item $p \nmid a_n$.
      \item $p^2 \nmid a_0$.
    \end{enumerate}
    Alors $P$ est irréductible dans $\mathbb{K}[X]$.
  \end{theorem}

  \reference[PER]{67}

  \begin{application}
    Soit $n \in \mathbb{N}^*$. Il existe des polynômes irréductibles de degré $n$ sur $\mathbb{Z}$.
  \end{application}

  \subsection{Applications}

  \subsubsection{En algèbre linéaire}

  Soit $E$ un espace vectoriel de dimension finie $n$ sur un corps $\mathbb{K}$. Soit $f : E \rightarrow E$ un endomorphisme de $E$.

  \reference[GOU21]{186}

  \begin{proposition}
    Il existe un unique polynôme de $\mathbb{K}[X]$ unitaire qui engendre l'idéal $\{ P \in \mathbb{K}[X] \mid P(f) = 0 \}$ : c'est le \textbf{polynôme minimal} de $f$, noté $\pi_f$. Il s'agit du polynôme unitaire de plus bas degré annulant $f$. Il divise tous les autres polynômes annulateurs de $f$.
  \end{proposition}

  \begin{theorem}[Lemme des noyaux]
    Soit $P = P_1 \dots P_k \in \mathbb{K}[X]$ où les polynômes $P_1, \dots, P_k$ sont premiers entre eux deux à deux. Alors,
    \[ \ker(P(f)) = \bigoplus_{i=1}^k \ker(P_i(f)) \]
  \end{theorem}

  \begin{application}
    $f$ est diagonalisable si et seulement si $\pi_f$ est scindé à racines simples.
  \end{application}

  \subsubsection{Systèmes de congruences}

  \reference[ROM21]{289}

  \begin{proposition}
    Soit $a$ un entier non nul. L'équation
    \[ ax \equiv 1 \mod n \]
    admet des solutions si et seulement si $\operatorname{pgcd}(a,n) = 1$.
  \end{proposition}

  \begin{corollary}
    Soient $a$ un entier non nul et $b$ un entier relatif. L'équation
    \[ ax \equiv b \mod n \]
    a des solutions si et seulement si $d = \operatorname{pgcd}(a,n) \mid b$. Dans ce cas, l'ensemble des solutions est
    \[ \left\{ \frac{b}{d}x_0 + k\frac{n}{d} \mid k \in \mathbb{Z} \right\} \]
    où $x_0$ est une solution de l'équation $\frac{a}{n}x \equiv 1 \mod n$.
  \end{corollary}

  \reference{285}
  \dev{theoreme-chinois}

  \begin{theorem}[Chinois]
    Soient $n_1, \dots, n_r \geq 2$ des entiers. On note $n = \prod_{i=1}^r n_i$ et $\pi_k = \pi_{{n_k}\mathbb{Z}}$ la surjection canonique de $\mathbb{Z}$ sur $\mathbb{Z}/k\mathbb{Z}$ pour tout $k \in \llbracket 1, r \rrbracket$.
    \newpar
    Les entiers $n_1, \dots, n_r$ sont premiers entre eux si et seulement si les anneaux $\mathbb{Z}/n\mathbb{Z}$ et $\prod_{i=1}^{r}\mathbb{Z}/n_i\mathbb{Z}$ sont isomorphes. Dans ce cas, l'isomorphisme est explicité par l'application
    \[
    \psi :
    \begin{array}{ccc}
      \mathbb{Z}/n\mathbb{Z} &\rightarrow& \prod_{i=1}^{r}\mathbb{Z}/n_i\mathbb{Z} \\
      \pi_{n}{k} &\mapsto& (\pi_i(k))_{i \in \llbracket 1, r \rrbracket}
    \end{array}
    \]
  \end{theorem}

  \reference{291}

  \begin{example}
    \[
    \begin{cases}
      k \equiv 2 \mod 4 \\
      k \equiv 3 \mod 5 \\
      k \equiv 1 \mod 9
    \end{cases}
    \]
    admet pour ensemble de solutions $\{ 838+180q \mid q \in \mathbb{Z} \}$.
  \end{example}
  %</content>
\end{document}
