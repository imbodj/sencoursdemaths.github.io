\input{../common}

\begin{document}
  %<*content>
  \development{algebra}{dimension-du-commutant}{Dimension du commutant}

  \summary{Dans ce développement, on montre en se ramenant à la résolution d'un système d'équations linéaires homogène que la dimension du commutant d'une matrice est plus grande que celle de l'espace de départ. On applique ensuite ce résultat pour donner une condition nécessaire et suffisante qui permettant de calculer le commutant de cette matrice.}

  Soient $\mathbb{K}$ un corps, $n \geq 1$ et $A \in \mathcal{M}_n(\mathbb{K})$.

  \begin{notation}
    \begin{itemize}
      \item On note $\mathcal{T}_n(\mathbb{K})$ l'ensemble des matrices carrées triangulaires supérieures d'ordre $n$ à coefficients dans le corps $\mathbb{K}$.
      \item On note $\mathcal{C}(A)$ le commutant de $A$.
    \end{itemize}
  \end{notation}

  \reference[GOU21]{289}

  \begin{remark}
    \label{dimension-du-commutant-1}
    On considère acquis le fait que si $\pi_A = \chi_A$, alors $A$ est cyclique :
    \[ \exists x \in \mathbb{K}^n \setminus \{ 0 \} \text{ tel que } (x, Ax, \dots, A^{n-1}x) \text{ est une base de } \mathbb{K}^n \]
  \end{remark}

  \reference[FGN2]{160}

  \begin{lemma}
    \label{dimension-du-commutant-2}
    \[ \dim_{\mathbb{K}}(\mathcal{C}(A)) \geq n \]
  \end{lemma}

  \begin{proof}
    Commençons par poser le système d'équations linéaires homogène
    \[ AX - XA = 0 \]
    d'inconnue $X = (x_{i,j})_{i,j \in \llbracket 1, n \rrbracket} \in \mathcal{M}_n(\mathbb{K})$. On note $\mathcal{S}$ l'espace des solutions de ce système.
    \newpar
    Plaçons-nous d'abord dans le cas où $A = (a_{i,j})_{i,j \in \llbracket 1, n \rrbracket} \in \mathcal{T}_n(\mathbb{K})$. Considérons ce système d'équations pour $X \in \mathcal{T}_n(\mathbb{K})$ ; on a alors $\frac{n(n+1)}{2}$ inconnues dans $\mathbb{K}$. Comme $AX-XA$ est triangulaire supérieure, dire que $X$ est solution revient à écrire $\frac{n(n+1)}{2}$ équations correspondant à la nullité des coefficients de $AX - XA$ dans la partie supérieure. Mais, de ces équations, on peut en retirer $n$ qui sont triviales (celles situées sur la diagonale, de la forme $a_{i,i} x_{i,i} - x_{i,i} a_{i,i}$). Ce système a donc $\frac{n(n+1)}{2} - n$ équations pour seulement $\frac{n(n+1)}{2}$ inconnues. Ainsi,
    \[ \dim_{\mathbb{K}}(\mathcal{C}(A)) = \dim_{\mathbb{K}}(\mathcal{S}) \geq \dim_{\mathbb{K}}(\mathcal{S} \, \cap \, \mathcal{T}_n(\mathbb{K})) \geq \frac{n(n+1)}{2} - \left( \frac{n(n+1)}{2} - n \right) = n \]
    Si $A$ n'est pas triangulaire mais est tout de même trigonalisable, il existe $P \in \mathrm{GL}_n(\mathbb{K})$ et $T \in \mathcal{T}_n(\mathbb{K})$ telles que $A = PTP^{-1}$. Ainsi,
    \begin{align*}
      X \in \mathcal{C}(A) &\iff AX = XA \\
      &\iff (PTP^{-1}) X = X (PTP^{-1}) \\
      &\iff T (P^{-1}XP) = (P^{-1}XP) T \\
      &\iff P^{-1}XP \in \mathcal{C}(T) \\
    \end{align*}
    et puisque $X \mapsto P^{-1}XP$ est un isomorphisme de $\mathcal{M}_n(\mathbb{K})$, on a
    \[ \dim_{\mathbb{K}}(\mathcal{C}(A)) = \dim_{\mathbb{K}}(\mathcal{C}(T)) \]
    donc on peut tout à fait se ramener au cas où $A$ est triangulaire supérieure.
    \newpar
    Enfin, si $A$ n'est pas trigonalisable, on considère $\mathbb{L}$ une extension de $\mathbb{K}$ sur laquelle $\chi_A$ est scindé. L'application
    \[ \varphi :
    \begin{array}{ccc}
      \mathcal{M}_n(\mathbb{K}) &\rightarrow& \mathcal{M}_n(\mathbb{K}) \\
      X &\mapsto& AX-XA
    \end{array}
    \]
    est linéaire, donc on peut considérer sa matrice $B \in \mathcal{M}_{n^2}(\mathbb{K})$ dans la base canonique de $\mathcal{M}_n(\mathbb{K})$ (il s'agit de la matrice associée au système d'équations linéaires). Alors $\mathcal{S} = \ker(B)$. Le rang est invariant par extension de corps, donc
    \[ \rang_{\mathbb{K}}(B) = \rang_{\mathbb{L}}(B) \]
    d'où
    \begin{align*}
      \dim_{\mathbb{K}}(\mathcal{S}) &= \dim_{\mathbb{K}}(\ker(B)) \\
      &= n^2 - \rang_{\mathbb{K}}(B) \\
      &= n^2 - \rang_{\mathbb{L}}(B) \\
      &= \dim_{\mathbb{L}}(\ker(B)) \\
      &\geq n
    \end{align*}
    car $A$ est trigonalisable dans $\mathbb{L}$. D'où le résultat.
  \end{proof}

  \begin{theorem}
    \[ \mathbb{K}[A] = \mathcal{C}(A) \iff \pi_A = \chi_A \]
  \end{theorem}

  \begin{proof}
    \uline{Sens direct :} Supposons $\mathbb{K}[A] = \mathcal{C}(A)$. Le \cref{dimension-du-commutant-2} entraîne que
    \[ \deg(\pi_A) = \dim(\mathbb{K}[A]) \geq n \]
    Mais comme $\deg(\pi_A) \leq n$, on a $\deg(\pi_A) = n$. Par le théorème de Cayley-Hamilton, on conclut
    \[ \pi_A = \chi_A \]
    \uline{Réciproque :} On suppose $\pi_A = \chi_A$. Par la \cref{dimension-du-commutant-1}, on peut trouver $x \in \in \mathbb{K}^n \setminus \{ 0 \}$ tel que $(x, Ax, \dots, A^{n-1}x)$ est une base de $\mathbb{K}^n$. Ainsi, l'application
    \[ \varphi :
    \begin{array}{ccc}
      \mathcal{C}(A) &\rightarrow& \mathbb{K}^n \\
      B &\mapsto& Bx
    \end{array}
    \]
    est linéaire injective. En effet, si $B \in \ker(\varphi)$, alors
    \[ \forall k \in \llbracket 0, n-1 \rrbracket, \, BA^kx = A^kBx = 0 \implies B = 0 \]
    car $B$ s'annule sur une base de $\mathbb{K}^n$. D'où $\dim(\mathcal{C}(A)) \leq \dim(\mathbb{K}^n) = n$. On déduit à l'aide du \cref{dimension-du-commutant-2} que
    \[ \dim(\mathcal{C}(A)) = n \]
    Notons de plus que
    \[ \dim(\mathbb{K}[A]) = \deg(\pi_A) = \deg(\chi_A) = n \]
    et comme $\mathbb{K}[A] \subseteq \mathcal{C}(A)$ (car tout polynôme en $A$ commute avec $A$), on a bien le résultat.
  \end{proof}
  %</content>
\end{document}
